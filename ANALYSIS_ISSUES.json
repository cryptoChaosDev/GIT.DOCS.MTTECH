{
  "analysis_metadata": {
    "file_analyzed": "bot.py",
    "total_lines": 5845,
    "analysis_date": "2026-01-23",
    "severity_levels": {
      "critical": "üî¥ –¢—Ä–µ–±—É–µ—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è",
      "high": "üü† –í–∞–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å",
      "medium": "üü° –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É–ª—É—á—à–∏—Ç—å",
      "low": "üîµ –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∏—Ç—å"
    }
  },
  "unused_code": {
    "unused_imports": [],
    "unused_functions": [
      {
        "name": "migrate_user_repos_format",
        "line": 1337,
        "type": "function",
        "severity": "medium",
        "description": "–§—É–Ω–∫—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –Ω–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è",
        "impact": "–ú–µ—Ä—Ç–≤—ã–π –∫–æ–¥, —É—Å–ª–æ–∂–Ω—è–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É",
        "recommendation": "–£–¥–∞–ª–∏—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏"
      },
      {
        "name": "apply_user_git_config",
        "line": 5681,
        "type": "function",
        "severity": "low",
        "description": "–§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è Git –∫–æ–Ω—Ñ–∏–≥–∞, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è",
        "impact": "–ù–µ–ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è",
        "recommendation": "–õ–∏–±–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é, –ª–∏–±–æ —É–¥–∞–ª–∏—Ç—å"
      }
    ],
    "unused_variables": [
      {
        "name": "AIORGRAM_AVAILABLE",
        "line": 2077,
        "type": "global_variable",
        "severity": "low",
        "value": "False",
        "description": "–§–ª–∞–≥ –¥–ª—è aiogram, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è",
        "recommendation": "–£–¥–∞–ª–∏—Ç—å"
      },
      {
        "name": "dp",
        "line": 2091,
        "type": "global_variable",
        "severity": "low",
        "value": "_StubDispatcher()",
        "description": "Stub dispatcher, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è",
        "recommendation": "–£–¥–∞–ª–∏—Ç—å"
      }
    ]
  },
  "critical_issues": [
    {
      "issue_id": "BUG-001",
      "title": "–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è repo_info –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–º–µ—Å—Ç–æ repo_data",
      "line": 5648,
      "function": "show_users_management",
      "severity": "critical",
      "description": "–í —Ñ—É–Ω–∫—Ü–∏–∏ show_users_management –Ω–∞ —Å—Ç—Ä–æ–∫–µ 5648 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è repo_info, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞. –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å repo_data –∏–∑ —Ü–∏–∫–ª–∞ for.",
      "current_code": "repo_url = repo_info.get('repo_url', '–Ω–µ –∑–∞–¥–∞–Ω')",
      "correct_code": "repo_url = repo_data.get('repo_url', '–Ω–µ –∑–∞–¥–∞–Ω')",
      "impact": "–ü—Ä–∏ –≤—ã–∑–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –æ—à–∏–±–∫–∞ NameError",
      "test_case": "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ –∫–Ω–æ–ø–∫—É –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏",
      "action_required": "–°–†–û–ß–ù–û –ò–°–ü–†–ê–í–ò–¢–¨"
    }
  ],
  "duplicated_code": {
    "summary": "256+ —Å—Ç—Ä–æ–∫ –ø–æ–≤—Ç–æ—Ä—è—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞ –≤ 5-7 –º–µ—Å—Ç–∞—Ö",
    "patterns": [
      {
        "pattern_id": "DUP-001",
        "name": "–ü–æ–∏—Å–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏",
        "size_per_occurrence": 8,
        "occurrences": 7,
        "total_lines": 56,
        "locations": [
          {
            "function": "handle_doc_selection",
            "line": 2838
          },
          {
            "function": "download_document",
            "line": 2919
          },
          {
            "function": "upload_changes",
            "line": 2987
          },
          {
            "function": "lock_document_by_name",
            "line": 3741
          },
          {
            "function": "unlock_document_by_name",
            "line": 3692
          },
          {
            "function": "handle_doc_name_input",
            "line": 3146
          },
          {
            "function": "get_document_keyboard",
            "line": 2741
          }
        ],
        "code_snippet": "for file_path in repo_root.rglob(doc_name):\n    if (file_path.suffix.lower() == '.docx' and \n        not any(part.startswith('.') for part in file_path.parts) and\n        '.git' not in file_path.parts and\n        '__pycache__' not in file_path.parts and\n        'node_modules' not in file_path.parts):\n        doc_path = file_path\n        break",
        "severity": "high",
        "recommendation": "–°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é find_document(repo_root, doc_name)"
      },
      {
        "pattern_id": "DUP-002",
        "name": "–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ LFS",
        "size_per_occurrence": 12,
        "occurrences": 5,
        "total_lines": 60,
        "locations": [
          {
            "function": "handle_document_upload",
            "line": 3305
          },
          {
            "function": "lock_document_by_name",
            "line": 3797
          },
          {
            "function": "unlock_document_by_name",
            "line": 3750
          },
          {
            "function": "get_document_keyboard",
            "line": 2741
          },
          {
            "function": "download_document",
            "line": 2939
          }
        ],
        "code_snippet": "rel_path = str(doc_path.relative_to(repo_root)).replace('\\\\', '/')\ntry:\n    lfs_lock_info = get_lfs_lock_info(rel_path, cwd=repo_root)\n    is_locked = lfs_lock_info is not None\nexcept Exception as e:\n    is_locked = False\n\nif is_locked and lfs_lock_info:\n    lfs_owner = lfs_lock_info.get('owner', '')\n    user_repo_info = get_user_repo(message.from_user.id)\n    user_github_username = user_repo_info.get('git_username')\n    is_lock_owner = lfs_owner == user_github_username",
        "severity": "high",
        "recommendation": "–°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å LockManager —Å –º–µ—Ç–æ–¥–æ–º is_locked_by_user()"
      },
      {
        "pattern_id": "DUP-003",
        "name": "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞",
        "size_per_occurrence": 4,
        "occurrences": 5,
        "total_lines": 20,
        "locations": [
          {
            "function": "check_lock_status",
            "line": 3937
          },
          {
            "function": "force_unlock_request",
            "line": 3886
          },
          {
            "function": "fix_lfs_issues",
            "line": 4142
          },
          {
            "function": "resync_repository",
            "line": 4626
          },
          {
            "function": "commit_all_changes",
            "line": 4299
          }
        ],
        "code_snippet": "is_admin = False\ntry:\n    user_id = str(message.from_user.id)\n    is_admin = user_id in ADMIN_IDS\nexcept Exception:\n    is_admin = False",
        "severity": "medium",
        "recommendation": "–°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é check_admin_rights(user_id) -> bool"
      },
      {
        "pattern_id": "DUP-004",
        "name": "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Git –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏",
        "size_per_occurrence": 10,
        "occurrences": 3,
        "total_lines": 30,
        "locations": [
          {
            "function": "configure_gitlab_credentials",
            "line": 601
          },
          {
            "function": "configure_git_with_credentials",
            "line": 1398
          },
          {
            "function": "configure_git_credentials",
            "line": 1432
          }
        ],
        "severity": "medium",
        "recommendation": "–°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å GitConfigManager"
      }
    ],
    "total_estimated_lines": 166,
    "total_with_variations": 256
  },
  "optimization_opportunities": [
    {
      "optimization_id": "OPT-001",
      "type": "–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ",
      "area": "user_repos loading",
      "current_implementation": "load_user_repos() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è 15+ —Ä–∞–∑, –∫–∞–∂–¥—ã–π —Ä–∞–∑ —á–∏—Ç–∞–µ—Ç JSON —Å –¥–∏—Å–∫–∞",
      "problem": "–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ IO - –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–ª–Ω—ã–π reload JSON",
      "proposed_solution": "–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å TTL –∫—ç—à (time-to-live 60 —Å–µ–∫—É–Ω–¥)",
      "expected_improvement": "–£–º–µ–Ω—å—à–µ–Ω–∏–µ IO –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞ 80-90%",
      "effort": "2-3 —á–∞—Å–∞",
      "priority": "high"
    },
    {
      "optimization_id": "OPT-002",
      "type": "–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ",
      "area": "LFS locks",
      "current_implementation": "get_lfs_lock_info() –≤—ã–∑—ã–≤–∞–µ—Ç subprocess –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞",
      "problem": "–ü—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —Å–ø–∏—Å–∫–∞ –∏–∑ 20 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ - 20 subprocess –≤—ã–∑–æ–≤–æ–≤ –∫ 'git lfs locks'",
      "proposed_solution": "–ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ 30 —Å–µ–∫—É–Ω–¥, –ø–æ–ª—É—á–∞—Ç—å –≤—Å–µ locks —Å—Ä–∞–∑—É",
      "expected_improvement": "–£–º–µ–Ω—å—à–µ–Ω–∏–µ subprocess –≤—ã–∑–æ–≤–æ–≤ —Å O(n) –¥–æ O(1)",
      "effort": "3-4 —á–∞—Å–∞",
      "priority": "high"
    },
    {
      "optimization_id": "OPT-003",
      "type": "–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥",
      "area": "Lock management",
      "current_implementation": "–õ–æ–≥–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ —Ä–∞–∑–±—Ä–æ—Å–∞–Ω–∞ –ø–æ –∫–æ–¥—É (5+ —Ñ—É–Ω–∫—Ü–∏–π)",
      "problem": "–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞, —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –æ—à–∏–±–∫–∏",
      "proposed_solution": "–°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å LockManager —Å –º–µ—Ç–æ–¥–∞–º–∏: create_lock(), remove_lock(), get_lock_info(), is_locked_by_user()",
      "expected_improvement": "–£–±–∏—Ä–∞–µ—Ç 200+ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞, —É–ª—É—á—à–∞–µ—Ç maintainability",
      "effort": "4-5 —á–∞—Å–æ–≤",
      "priority": "high"
    },
    {
      "optimization_id": "OPT-004",
      "type": "–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥",
      "area": "Document searching",
      "current_implementation": "–ü–æ–∏—Å–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –≤ 7 —Ñ—É–Ω–∫—Ü–∏—è—Ö",
      "problem": "–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏, –æ—à–∏–±–∫–∏",
      "proposed_solution": "–°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é find_document(repo_root, doc_name) -> Path",
      "expected_improvement": "–£–±–∏—Ä–∞–µ—Ç 56 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞",
      "effort": "1-2 —á–∞—Å–∞",
      "priority": "medium"
    },
    {
      "optimization_id": "OPT-005",
      "type": "–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥",
      "area": "Session management",
      "current_implementation": "–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ + globals() dict",
      "problem": "–ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ, —Å–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏",
      "proposed_solution": "–°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å SessionManager –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ–º–∏ —Å–µ—Å—Å–∏—è–º–∏",
      "expected_improvement": "–õ—É—á—à–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞, –º–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫",
      "effort": "3-4 —á–∞—Å–∞",
      "priority": "medium"
    },
    {
      "optimization_id": "OPT-006",
      "type": "–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥",
      "area": "Permission checking",
      "current_implementation": "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω –ø—Ä–∞–≤ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –≤ 5+ –º–µ—Å—Ç–∞—Ö",
      "problem": "–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ—à–∏–±–∫–∏ –≤ –ø—Ä–æ–≤–µ—Ä–∫–µ",
      "proposed_solution": "–°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å PermissionManager —Å –º–µ—Ç–æ–¥–∞–º–∏: is_admin(), is_lock_owner(), can_edit()",
      "expected_improvement": "–£–±–∏—Ä–∞–µ—Ç 20 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞, —É–ª—É—á—à–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å",
      "effort": "2-3 —á–∞—Å–∞",
      "priority": "medium"
    },
    {
      "optimization_id": "OPT-007",
      "type": "–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å",
      "area": "Git operations",
      "current_implementation": "subprocess.run() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è 30+ —Ä–∞–∑ –±–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤",
      "problem": "–ú–µ–¥–ª–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å Git",
      "proposed_solution": "–ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã git status/fetch –Ω–∞ 10-30 —Å–µ–∫—É–Ω–¥",
      "expected_improvement": "–£–ª—É—á—à–µ–Ω–∏–µ UI responsiveness –Ω–∞ 20-30%",
      "effort": "2-3 —á–∞—Å–∞",
      "priority": "low"
    }
  ],
  "frequently_used_functions": [
    {
      "name": "get_user_repo",
      "calls": "20+",
      "type": "hot_path",
      "candidates_for_caching": true,
      "impact": "High - called on every user interaction"
    },
    {
      "name": "get_repo_for_user_id",
      "calls": "15+",
      "type": "hot_path",
      "candidates_for_caching": true,
      "impact": "High - called frequently in document operations"
    },
    {
      "name": "load_user_repos",
      "calls": "15+",
      "type": "hot_path",
      "candidates_for_caching": true,
      "impact": "High - involves disk I/O"
    },
    {
      "name": "save_user_repos",
      "calls": "10+",
      "type": "critical_path",
      "candidates_for_caching": false,
      "impact": "High - data persistence"
    },
    {
      "name": "get_document_keyboard",
      "calls": "8+",
      "type": "ui_function",
      "candidates_for_caching": false,
      "impact": "Medium - called for UI rendering"
    },
    {
      "name": "get_main_keyboard",
      "calls": "8+",
      "type": "ui_function",
      "candidates_for_caching": false,
      "impact": "Medium - called for UI rendering"
    },
    {
      "name": "get_lfs_lock_info",
      "calls": "8+",
      "type": "hot_path",
      "candidates_for_caching": true,
      "impact": "High - involves subprocess calls"
    },
    {
      "name": "subprocess.run with git",
      "calls": "30+",
      "type": "critical_path",
      "candidates_for_caching": true,
      "impact": "Very High - performance bottleneck"
    }
  ],
  "code_structure_issues": [
    {
      "issue_id": "STRUCT-001",
      "title": "–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ globals() dict",
      "severity": "medium",
      "description": "–ö–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç globals().get('user_edit_sessions', {}) –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö –≤–º–µ—Å—Ç–æ –ø—Ä—è–º—ã—Ö –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö",
      "locations": [
        {
          "function": "main",
          "line": 5033
        },
        {
          "function": "main",
          "line": 5076
        }
      ],
      "impact": "–ù–µ–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Å–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏",
      "recommendation": "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —á–µ—Ä–µ–∑ –∫–ª–∞—Å—Å SessionManager"
    },
    {
      "issue_id": "STRUCT-002",
      "title": "–°–º–µ—à–∏–≤–∞–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞",
      "severity": "low",
      "description": "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ subprocess.run() –≤ async —Ñ—É–Ω–∫—Ü–∏—è—Ö (–º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å event loop)",
      "locations": [
        {
          "function": "handle_document_upload",
          "line": 3405
        },
        {
          "function": "update_repository",
          "line": 4070
        }
      ],
      "recommendation": "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å asyncio.to_thread() –∏–ª–∏ aioshell –¥–ª—è async subprocess"
    },
    {
      "issue_id": "STRUCT-003",
      "title": "–ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–π error handling",
      "severity": "low",
      "description": "–†–∞–∑–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∫ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ—à–∏–±–æ–∫: try-except, –ø—Ä–æ–≤–µ—Ä–∫–∞ returncode, ignore errors",
      "impact": "–¢—Ä—É–¥–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –æ—à–∏–±–∫–∏, –Ω–µ–ø–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ",
      "recommendation": "–°–æ–∑–¥–∞—Ç—å DecoratorFactory –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫"
    }
  ],
  "security_considerations": [
    {
      "issue_id": "SEC-001",
      "title": "–•—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –ø–∞–º—è—Ç–∏",
      "severity": "medium",
      "description": "GitLab —Ç–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ (session['password'])",
      "recommendation": "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å secure key manager –∏–ª–∏ environment variables"
    },
    {
      "issue_id": "SEC-002",
      "title": "–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö",
      "severity": "low",
      "description": "–§—É–Ω–∫—Ü–∏—è _mask_repo_url() –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è URL, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ",
      "recommendation": "–î–æ–±–∞–≤–∏—Ç—å –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –ø—Ä–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏"
    }
  ],
  "recommendations_summary": {
    "immediate_actions": [
      {
        "priority": 1,
        "action": "–ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫—É –Ω–∞ —Å—Ç—Ä–æ–∫–µ 5648: repo_info ‚Üí repo_data",
        "effort_hours": 0.25,
        "impact": "critical"
      },
      {
        "priority": 2,
        "action": "–£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (AIORGRAM_AVAILABLE, dp)",
        "effort_hours": 0.5,
        "impact": "high"
      },
      {
        "priority": 3,
        "action": "–£–¥–∞–ª–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é migrate_user_repos_format() –∏–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å",
        "effort_hours": 0.5,
        "impact": "medium"
      }
    ],
    "refactoring_recommendations": [
      {
        "priority": 1,
        "action": "–°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å LockManager",
        "effort_hours": 4.5,
        "impact": "high",
        "description": "–£–±–∏—Ä–∞–µ—Ç 200+ —Å—Ç—Ä–æ–∫ –ø–æ–≤—Ç–æ—Ä—è—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞"
      },
      {
        "priority": 2,
        "action": "–§—É–Ω–∫—Ü–∏—è find_document() –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ñ–∞–π–ª–æ–≤",
        "effort_hours": 1.5,
        "impact": "high",
        "description": "–£–±–∏—Ä–∞–µ—Ç 56 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞"
      },
      {
        "priority": 3,
        "action": "–ö–ª–∞—Å—Å SessionManager –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏—è–º–∏",
        "effort_hours": 3.5,
        "impact": "medium",
        "description": "–£–ª—É—á—à–∞–µ—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –∏ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å"
      }
    ],
    "optimization_recommendations": [
      {
        "priority": 1,
        "action": "–ö—ç—à –¥–ª—è user_repos (TTL 60s)",
        "effort_hours": 2.5,
        "impact": "high",
        "description": "–£–º–µ–Ω—å—à–µ–Ω–∏–µ IO –Ω–∞ 80-90%"
      },
      {
        "priority": 2,
        "action": "–ö—ç—à –¥–ª—è LFS locks (TTL 30s)",
        "effort_hours": 3.5,
        "impact": "high",
        "description": "–£–º–µ–Ω—å—à–µ–Ω–∏–µ subprocess –≤—ã–∑–æ–≤–æ–≤ —Å O(n) –¥–æ O(1)"
      }
    ]
  },
  "summary": {
    "total_issues_found": 14,
    "critical_issues": 1,
    "high_priority_issues": 4,
    "medium_priority_issues": 5,
    "low_priority_issues": 4,
    "duplicated_code_lines": 256,
    "estimated_improvement_after_refactoring": "30-40% reduction in codebase complexity",
    "estimated_effort": "15-20 hours for full optimization",
    "recommendation": "Start with critical bug fix, then prioritize high-impact refactoring and caching optimizations"
  }
}
